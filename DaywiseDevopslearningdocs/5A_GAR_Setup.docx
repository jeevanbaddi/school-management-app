ğŸš€ STEP-5A: GCP Artifact Registry Setup (Manual â€“ First)

ğŸ”‘ DevOps principle (4+ yrs):
Never automate infrastructure you havenâ€™t created manually at least once.

ğŸ¯ Goal of Step-5A

By the end of this step:

âœ… Artifact Registry (Docker repo) exists in GCP

âœ… Jenkins can push Docker images to GCP

âœ… You clearly understand why & how this works

1ï¸âƒ£ What is Artifact Registry? (MUST KNOW)

Definition (Interview-ready):

Artifact Registry is a managed GCP service used to store, version, and manage container images and other build artifacts securely.

Why we need it:

Jenkins builds Docker image

GKE cannot pull images from Jenkins local machine

GKE can pull from Artifact Registry

2ï¸âƒ£ Verify GCP Project & Auth (VERY IMPORTANT)

Run in Ubuntu:

gcloud auth list


You should see your email marked as ACTIVE.

gcloud config list project


If project is not set:

gcloud config set project <YOUR_PROJECT_ID>


ğŸ”‘ MUST KNOW

Terraform & Jenkins both rely on this context

Wrong project = silent failures later

3ï¸âƒ£ Enable Artifact Registry API
gcloud services enable artifactregistry.googleapis.com


Why?

GCP services are disabled by default

Terraform will fail if API isnâ€™t enabled

4ï¸âƒ£ Create Artifact Registry Repository (Docker)
Command:
gcloud artifacts repositories create school-app-repo \
  --repository-format=docker \
  --location=us-central1 \
  --description="Docker images for school management app"

Verify:
gcloud artifacts repositories list


Expected:

school-app-repo   DOCKER   us-central1

ğŸ”‘ MUST KNOW (Region Choice)

us-central1 â†’ cheapest & common

Same region as GKE = faster pulls

5ï¸âƒ£ Configure Docker to Authenticate with GCP

This is CRITICAL.

gcloud auth configure-docker us-central1-docker.pkg.dev


This updates:

~/.docker/config.json


ğŸ”‘ MUST KNOW

Docker itself doesnâ€™t know GCP

This step links Docker â†” GCP credentials

6ï¸âƒ£ Artifact Registry Image Naming Convention (IMPORTANT)

Format:

REGION-docker.pkg.dev/PROJECT_ID/REPO_NAME/IMAGE_NAME:TAG


Example:

us-central1-docker.pkg.dev/my-project/school-app-repo/school-app:1.0


You must remember this format â€” interviewers love to ask this.

7ï¸âƒ£ Test Push Manually (Before Jenkins â€“ BEST PRACTICE)
Build image:
docker build -t school-app:1.0 .

Tag image:
docker tag school-app:1.0 \
us-central1-docker.pkg.dev/<PROJECT_ID>/school-app-repo/school-app:1.0

Push image:
docker push \
us-central1-docker.pkg.dev/<PROJECT_ID>/school-app-repo/school-app:1.0

8ï¸âƒ£ Verify Image in GCP Console

GCP Console â†’
Artifact Registry â†’ school-app-repo â†’ Images

You should see:

school-app:1.0


ğŸ‰ This confirms:

Registry works

Auth works

Image naming is correct

ğŸ§  Interview-Ready Explanation

Q: How do you make Docker images available to GKE?

Your Answer:

â€œWe push Docker images to GCP Artifact Registry. Jenkins builds and pushes the image, and GKE pulls it securely using IAM permissions.â€

ğŸ”¥ Strong answer.

âœ… STEP-5A COMPLETE CHECKLIST

âœ” Artifact Registry created
âœ” Docker authenticated with GCP
âœ” Image pushed successfully
âœ” Ready for Jenkins integration